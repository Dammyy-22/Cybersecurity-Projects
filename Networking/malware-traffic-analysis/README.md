# Malware Traffic Analysis: Exploit Kit Detection

## Project Overview

This project involves analyzing a packet capture (PCAP) file to investigate suspicious network traffic. The goal was to identify indicators of compromise (IOCs), determine the source of infection, and recover the malicious payloads delivered to the victim machine.

![](C:\Users\hp\Documents\Projects\CyberSecurity\Cybersecurity-projects\Networking\malware-traffic-analysis\screenshots\Http%20filter.png)

## Lab Environment & Tools

* **Hypervisor:** VMware Workstation
* **Operating System:** Windows 10
* **Network Analysis:** Wireshark
* **File Analysis:** HashMyFiles
* **Threat Intelligence:** VirusTotal

## Investigation Methodology

1. **Packet Filtering:** Used Wireshark to filter for `http.request` to isolate web traffic and analyze the Protocol Hierarchy statistics.
   
   <br/>![](C:\Users\hp\Documents\Projects\CyberSecurity\Cybersecurity-projects\Networking\malware-traffic-analysis\screenshots\Http%20filter.png) <br/>

2. **Column Customization:** Added Source Port, Destination Port, and MAC Address columns to the main view to track specific communication flows. <br/><br/>

3. **Payload Extraction:** Used "Export Objects (HTTP)" to extract files transferred during the session. <br/><br/>
   
   ![<br/> <br/> <br/>](C:\Users\hp\Documents\Projects\CyberSecurity\Cybersecurity-projects\Networking\malware-traffic-analysis\screenshots\http%20object%20list.png)

4. **Hash Verification:** Generated file hashes (MD5/SHA256) using HashMyFiles.

![ <br/> <br/>](C:\Users\hp\Documents\Projects\CyberSecurity\Cybersecurity-projects\Networking\malware-traffic-analysis\screenshots\Files%20hashes.png) <br/>

5. **Threat Intel Lookup:** Cross-referenced hashes with VirusTotal to confirm malicious signatures.

![](C:\Users\hp\Documents\Projects\CyberSecurity\Cybersecurity-projects\Networking\malware-traffic-analysis\screenshots\jar%20file.png)

![](C:\Users\hp\Documents\Projects\CyberSecurity\Cybersecurity-projects\Networking\malware-traffic-analysis\screenshots\not%20infected%20file.png)

![](C:\Users\hp\Documents\Projects\CyberSecurity\Cybersecurity-projects\Networking\malware-traffic-analysis\screenshots\flash%20file.png)

## Findings & Indicators of Compromise (IOCs)

### Victim Details

* **IP Address:** 172.16.165.165
* **Hostname:** K34EN6W3N-PC
* **MAC Address:** f0:19:af:02:9b:f1

### Threat Details

* **Compromised IP:** 37.200.69.143
* **Malicious Domain:** trustandprobaterealty.com
* **Exploit URL:** stand.trustandprobaterealty.com

### Recovered Artifacts

| Filename / Description  | MD5 Hash                           | Status       |
|:----------------------- |:---------------------------------- |:------------ |
| **Java Exploit**        | `1e34fdebbf655cebea78b45e43520ddf` | **INFECTED** |
| **Flash (SWF) Exploit** | `7b3baa7d6bb3720f369219789e38d6ab` | **INFECTED** |
| **Clean File**          | `d276c86dcdbcdb6b74ee02496bc90d98` | CLEAN        |

## Conclusion

The analysis confirms that the host `K34EN6W3N-PC` was compromised via a drive-by download from `trustandprobaterealty.com`. The infection vector involved both Java and Flash-based exploits delivered via HTTP.
